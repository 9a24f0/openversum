<script lang="ts">
	import { interpolateString as interpolate } from 'd3-interpolate';

	import { onDestroy } from 'svelte';
	import { tweened } from 'svelte/motion';
	import { linear } from 'svelte/easing';

	export let w: number = 960;
	const P1 =
		'M0 116L34.5 110.8C69 105.7 138 95.3 206.8 85.5C275.7 75.7 344.3 66.3 413.2 67.5C482 68.7 551 80.3 620 99.2C689 118 758 144 826.8 148.8C895.7 153.7 964.3 137.3 1033.2 119C1102 100.7 1171 80.3 1205.5 70.2L1240 60L1240 241L1205.5 241C1171 241 1102 241 1033.2 241C964.3 241 895.7 241 826.8 241C758 241 689 241 620 241C551 241 482 241 413.2 241C344.3 241 275.7 241 206.8 241C138 241 69 241 34.5 241L0 241Z';

	//'M0 377L26.7 369.8C53.3 362.7 106.7 348.3 160 340.3C213.3 332.3 266.7 330.7 320 354C373.3 377.3 426.7 425.7 480 449.7C533.3 473.7 586.7 473.3 640 465.3C693.3 457.3 746.7 441.7 800 434.2C853.3 426.7 906.7 427.3 933.3 427.7L960 428L960 541L933.3 541C906.7 541 853.3 541 800 541C746.7 541 693.3 541 640 541C586.7 541 533.3 541 480 541C426.7 541 373.3 541 320 541C266.7 541 213.3 541 160 541C106.7 541 53.3 541 26.7 541L0 541Z';
	const P2 =
		'M0 64L34.5 84.8C69 105.7 138 147.3 206.8 165.3C275.7 183.3 344.3 177.7 413.2 164C482 150.3 551 128.7 620 110.5C689 92.3 758 77.7 826.8 69.2C895.7 60.7 964.3 58.3 1033.2 70.3C1102 82.3 1171 108.7 1205.5 121.8L1240 135L1240 241L1205.5 241C1171 241 1102 241 1033.2 241C964.3 241 895.7 241 826.8 241C758 241 689 241 620 241C551 241 482 241 413.2 241C344.3 241 275.7 241 206.8 241C138 241 69 241 34.5 241L0 241Z';

	//'M0 444L26.7 446.8C53.3 449.7 106.7 455.3 160 452.8C213.3 450.3 266.7 439.7 320 429.5C373.3 419.3 426.7 409.7 480 394.2C533.3 378.7 586.7 357.3 640 368.2C693.3 379 746.7 422 800 440.7C853.3 459.3 906.7 453.7 933.3 450.8L960 448L960 541L933.3 541C906.7 541 853.3 541 800 541C746.7 541 693.3 541 640 541C586.7 541 533.3 541 480 541C426.7 541 373.3 541 320 541C266.7 541 213.3 541 160 541C106.7 541 53.3 541 26.7 541L0 541Z';
	const P3 =
		'M0 59L34.5 80.2C69 101.3 138 143.7 206.8 148.3C275.7 153 344.3 120 413.2 102.2C482 84.3 551 81.7 620 94.7C689 107.7 758 136.3 826.8 149.5C895.7 162.7 964.3 160.3 1033.2 153.7C1102 147 1171 136 1205.5 130.5L1240 125L1240 241L1205.5 241C1171 241 1102 241 1033.2 241C964.3 241 895.7 241 826.8 241C758 241 689 241 620 241C551 241 482 241 413.2 241C344.3 241 275.7 241 206.8 241C138 241 69 241 34.5 241L0 241Z';

	//'M0 331L26.7 344.3C53.3 357.7 106.7 384.3 160 405.8C213.3 427.3 266.7 443.7 320 441.3C373.3 439 426.7 418 480 421.5C533.3 425 586.7 453 640 460.2C693.3 467.3 746.7 453.7 800 442.2C853.3 430.7 906.7 421.3 933.3 416.7L960 412L960 541L933.3 541C906.7 541 853.3 541 800 541C746.7 541 693.3 541 640 541C586.7 541 533.3 541 480 541C426.7 541 373.3 541 320 541C266.7 541 213.3 541 160 541C106.7 541 53.3 541 26.7 541L0 541Z';

	const duration = 5000;
	const path = tweened(P1, {
		duration: duration,
		easing: linear,
		interpolate: interpolate
	});

	const animateOnce = () => {
		path.set(P2);
		setTimeout(() => {
			path.set(P3);
			setTimeout(() => path.set(P1), duration);
		}, duration);
	};
	animateOnce();
	const intervalId = setInterval(animateOnce, 3 * duration);

	onDestroy(() => {
		clearInterval(intervalId);
	});
</script>

<!-- <svg
	id="visual"
	viewBox="0 0 900 600"
	class="w-full h-full overflow-visible -z-10"
	xmlns="http://www.w3.org/2000/svg"
	xmlns:xlink="http://www.w3.org/1999/xlink"
	version="1.1"
> -->

<svg
	id="visual"
	preserveAspectRatio="none"
	viewBox="0 0 1240 240"
	width={w}
	class="h-full"
	xmlns="http://www.w3.org/2000/svg"
	xmlns:xlink="http://www.w3.org/1999/xlink"
	version="1.1"
	><path width={w} d={$path} fill="#FFFFFF" stroke-linecap="round" stroke-linejoin="miter" /></svg
>
